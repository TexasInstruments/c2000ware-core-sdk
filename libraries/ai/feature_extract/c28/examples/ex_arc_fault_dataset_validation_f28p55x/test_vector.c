/*
 * global.c
 *
 *  Created on: Nov 12, 2021
 *      Author: a0199881
 */

#include "device.h"
//#include "Pre_processing.h"
//#include "fpu32/fpu_fft_hann.h"

// ADC input test vector
//uint16_t ADC_input_A[1024] = {2098, 2119, 2072, 2004, 1975, 2017, 2088, 2125, 2093, 2021, 1976, 2000, 2069, 2120, 2103, 2038, 1983, 1990, 2052, 2112, 2116, 2058, 1993, 1980, 2033, 2100, 2122, 2076, 2005, 1975, 2014, 2085, 2125, 2093, 2022, 1976, 2000, 2070, 2121, 2105, 2038, 1981, 1988, 2050, 2112, 2117, 2060, 1995, 1981, 2032, 2099, 2119, 2074, 2005, 1976, 2016, 2088, 2123, 2092, 2021, 1976, 1999, 2070, 2122, 2106, 2036, 1979, 1986, 2050, 2114, 2119, 2060, 1994, 1980, 2031, 2099, 2120, 2074, 2006, 1979, 2017, 2084, 2121, 2091, 2023, 1979, 2001, 2070, 2122, 2105, 2037, 1979, 1987, 2051, 2114, 2118, 2057, 1992, 1979, 2034, 2101, 2121, 2073, 2003, 1975, 2015, 2085, 2123, 2093, 2024, 1978, 2000, 2068, 2118, 2104, 2038, 1982, 1988, 2051, 2113, 2117, 2059, 1993, 1980, 2032, 2100, 2120, 2074, 2005, 1976, 2015, 2086, 2123, 2092, 2021, 1978, 2001, 2069, 2119, 2103, 2038, 1981, 1989, 2051, 2112, 2116, 2059, 1993, 1979, 2032, 2099, 2121, 2076, 2005, 1975, 2015, 2085, 2123, 2092, 2022, 1979, 2001, 2069, 2120, 2103, 2037, 1980, 1988, 2052, 2114, 2117, 2059, 1993, 1979, 2032, 2100, 2121, 2073, 2004, 1975, 2015, 2086, 2125, 2093, 2023, 1977, 2001, 2068, 2119, 2103, 2038, 1983, 1989, 2052, 2112, 2116, 2058, 1993, 1979, 2032, 2100, 2121, 2075, 2006, 1976, 2014, 2085, 2124, 2092, 2022, 1977, 2000, 2070, 2121, 2104, 2037, 1980, 1988, 2052, 2114, 2116, 2058, 1992, 1980, 2033, 2099, 2119, 2073, 2005, 1976, 2015, 2085, 2124, 2093, 2024, 1977, 1999, 2067, 2119, 2104, 2038, 1980, 1988, 2051, 2114, 2116, 2057, 1992, 1980, 2033, 2101, 2121, 2074, 2004, 1976, 2015, 2085, 2123, 2092, 2023, 1978, 2000, 2069, 2119, 2105, 2039, 1982, 1987, 2050, 2113, 2117, 2060, 1993, 1979, 2033, 2101, 2121, 2074, 2005, 1975, 2017, 2086, 2124, 2091, 2023, 1978, 2002, 2069, 2118, 2103, 2038, 1981, 1988, 2051, 2113, 2118, 2060, 1992, 1979, 2032, 2101, 2121, 2074, 2004, 1975, 2017, 2087, 2124, 2091, 2021, 1977, 2001, 2071, 2120, 2105, 2038, 1981, 1988, 2052, 2114, 2117, 2057, 1990, 1978, 2033, 2103, 2125, 2076, 2005, 1973, 2012, 2084, 2123, 2094, 2025, 1979, 2000, 2066, 2115, 2100, 2037, 1985, 1993, 2056, 2114, 2114, 2055, 1989, 1978, 2033, 2103, 2124, 2076, 2003, 1972, 2012, 2086, 2127, 2096, 2023, 1976, 1997, 2067, 2118, 2104, 2040, 1984, 1990, 2051, 2111, 2113, 2057, 1994, 1982, 2034, 2100, 2120, 2074, 2004, 1974, 2014, 2086, 2125, 2095, 2023, 1975, 1998, 2067, 2120, 2106, 2038, 1981, 1988, 2050, 2112, 2117, 2059, 1993, 1982, 2033, 2100, 2119, 2073, 2005, 1976, 2015, 2085, 2124, 2094, 2023, 1978, 1999, 2068, 2119, 2105, 2038, 1981, 1986, 2050, 2114, 2118, 2059, 1991, 1978, 2032, 2101, 2122, 2074, 2005, 1975, 2014, 2086, 2123, 2093, 2023, 1978, 1999, 2068, 2120, 2105, 2040, 1981, 1987, 2049, 2112, 2116, 2060, 1994, 1981, 2033, 2100, 2120, 2074, 2003, 1974, 2015, 2086, 2125, 2095, 2024, 1976, 1997, 2067, 2119, 2105, 2039, 1982, 1988, 2050, 2113, 2118, 2061, 1994, 1978, 2031, 2098, 2121, 2076, 2006, 1975, 2014, 2085, 2123, 2093, 2024, 1977, 2000, 2068, 2120, 2104, 2038, 1980, 1986, 2049, 2112, 2117, 2062, 1994, 1979, 2031, 2098, 2121, 2076, 2005, 1975, 2014, 2085, 2125, 2094, 2024, 1978, 2000, 2067, 2118, 2104, 2039, 1982, 1987, 2049, 2112, 2117, 2061, 1995, 1980, 2031, 2098, 2121, 2076, 2006, 1975, 2013, 2085, 2124, 2094, 2023, 1977, 1999, 2068, 2119, 2104, 2039, 1981, 1987, 2049, 2113, 2117, 2061, 1994, 1979, 2030, 2098, 2121, 2077, 2007, 1975, 2012, 2084, 2123, 2095, 2025, 1978, 1999, 2067, 2120, 2105, 2039, 1981, 1987, 2050, 2112, 2117, 2061, 1995, 1981, 2031, 2098, 2120, 2075, 2005, 1975, 2013, 2084, 2123, 2095, 2027, 1977, 1998, 2066, 2119, 2106, 2040, 1982, 1987, 2049, 2112, 2118, 2061, 1994, 1979, 2031, 2100, 2122, 2076, 2006, 1976, 2014, 2083, 2122, 2094, 2025, 1980, 2000, 2067, 2118, 2104, 2039, 1982, 1986, 2048, 2112, 2120, 2063, 1995, 1978, 2030, 2099, 2122, 2075, 2005, 1975, 2014, 2085, 2124, 2094, 2025, 1979, 2002, 2068, 2117, 2103, 2038, 1982, 1988, 2051, 2113, 2119, 2060, 1993, 1978, 2030, 2100, 2123, 2076, 2007, 1975, 2013, 2083, 2122, 2094, 2024, 1979, 2001, 2069, 2120, 2105, 2038, 1981, 1985, 2048, 2112, 2119, 2062, 1995, 1980, 2031, 2097, 2121, 2076, 2007, 1975, 2014, 2083, 2123, 2093, 2025, 1979, 2000, 2069, 2119, 2104, 2037, 1980, 1987, 2050, 2114, 2119, 2061, 1994, 1979, 2031, 2098, 2122, 2076, 2006, 1975, 2012, 2084, 2123, 2096, 2026, 1977, 1999, 2067, 2118, 2104, 2040, 1983, 1987, 2049, 2111, 2116, 2059, 1995, 1981, 2032, 2100, 2121, 2075, 2005, 1974, 2013, 2084, 2123, 2095, 2025, 1979, 2000, 2067, 2118, 2105, 2039, 1981, 1986, 2048, 2113, 2118, 2062, 1995, 1979, 2029, 2098, 2120, 2075, 2006, 1977, 2015, 2084, 2122, 2093, 2024, 1978, 1999, 2067, 2119, 2106, 2041, 1982, 1986, 2049, 2111, 2117, 2060, 1994, 1979, 2032, 2100, 2122, 2075, 2005, 1975, 2013, 2084, 2124, 2095, 2026, 1979, 1999, 2067, 2118, 2105, 2040, 1983, 1987, 2048, 2112, 2117, 2060, 1995, 1979, 2031, 2100, 2121, 2074, 2004, 1975, 2014, 2085, 2124, 2094, 2023, 1978, 1999, 2068, 2120, 2105, 2039, 1982, 1986, 2047, 2112, 2118, 2062, 1996, 1979, 2030, 2098, 2121, 2076, 2006, 1975, 2013, 2085, 2125, 2095, 2024, 1977, 2000, 2068, 2120, 2106, 2039, 1983, 1987, 2048, 2111, 2117, 2061, 1996, 1980, 2030, 2099, 2121, 2076, 2005, 1974, 2012, 2085, 2125, 2095, 2025, 1978, 1999, 2066, 2118, 2105, 2040, 1981, 1987, 2049, 2112, 2117, 2060, 1995, 1980, 2030, 2099, 2121, 2075, 2006, 1975, 2013, 2084, 2124, 2095, 2025, 1977, 1998, 2066, 2120, 2108, 2041, 1981, 1985, 2046, 2112, 2118, 2062, 1996, 1981, 2032, 2099, 2121, 2075, 2005, 1974, 2013, 2084, 2125, 2096, 2027, 1978, 1998, 2065, 2118, 2105, 2040, 1981, 1987, 2049, 2113, 2118, 2061, 1994, 1979, 2031, 2100, 2122, 2075, 2006, 1975, 2013, 2085, 2124, 2095, 2024, 1977, 1998, 2066, 2120, 2106, 2042, 1982, 1985, 2047, 2111, 2118, 2062, 1995, 1979, 2030, 2099, 2122, 2076, 2004, 1975, 2014, 2085, 2124, 2094, 2025, 1978, 1999, 2067, 2119, 2105, 2040, 1981, 1987, 2048, 2112, 2119, 2063, 1995, 1977, 2029, 2099, 2123, 2077, 2006, 1974, 2012, 2084, 2124, 2096, 2026, 1977, 1998, 2065, 2118, 2105, 2041, 1983, 1987, 2048, 2111, 2117, 2062, 1996, 1979, 2030, 2099, 2121, 2076, 2005, 1973, 2012, 2085, 2127, 2097, 2024, 1975, 1996, 2066, 2120, 2108, 2041, 1983, 1985, 2046, 2111, 2120, 2063, 1997, 1980
//};
float raw_input_test[1024] = {2098, 2119, 2072, 2004, 1975, 2017, 2088, 2125, 2093, 2021, 1976, 2000, 2069, 2120, 2103, 2038, 1983, 1990, 2052, 2112, 2116, 2058, 1993, 1980, 2033, 2100, 2122, 2076, 2005, 1975, 2014, 2085, 2125, 2093, 2022, 1976, 2000, 2070, 2121, 2105, 2038, 1981, 1988, 2050, 2112, 2117, 2060, 1995, 1981, 2032, 2099, 2119, 2074, 2005, 1976, 2016, 2088, 2123, 2092, 2021, 1976, 1999, 2070, 2122, 2106, 2036, 1979, 1986, 2050, 2114, 2119, 2060, 1994, 1980, 2031, 2099, 2120, 2074, 2006, 1979, 2017, 2084, 2121, 2091, 2023, 1979, 2001, 2070, 2122, 2105, 2037, 1979, 1987, 2051, 2114, 2118, 2057, 1992, 1979, 2034, 2101, 2121, 2073, 2003, 1975, 2015, 2085, 2123, 2093, 2024, 1978, 2000, 2068, 2118, 2104, 2038, 1982, 1988, 2051, 2113, 2117, 2059, 1993, 1980, 2032, 2100, 2120, 2074, 2005, 1976, 2015, 2086, 2123, 2092, 2021, 1978, 2001, 2069, 2119, 2103, 2038, 1981, 1989, 2051, 2112, 2116, 2059, 1993, 1979, 2032, 2099, 2121, 2076, 2005, 1975, 2015, 2085, 2123, 2092, 2022, 1979, 2001, 2069, 2120, 2103, 2037, 1980, 1988, 2052, 2114, 2117, 2059, 1993, 1979, 2032, 2100, 2121, 2073, 2004, 1975, 2015, 2086, 2125, 2093, 2023, 1977, 2001, 2068, 2119, 2103, 2038, 1983, 1989, 2052, 2112, 2116, 2058, 1993, 1979, 2032, 2100, 2121, 2075, 2006, 1976, 2014, 2085, 2124, 2092, 2022, 1977, 2000, 2070, 2121, 2104, 2037, 1980, 1988, 2052, 2114, 2116, 2058, 1992, 1980, 2033, 2099, 2119, 2073, 2005, 1976, 2015, 2085, 2124, 2093, 2024, 1977, 1999, 2067, 2119, 2104, 2038, 1980, 1988, 2051, 2114, 2116, 2057, 1992, 1980, 2033, 2101, 2121, 2074, 2004, 1976, 2015, 2085, 2123, 2092, 2023, 1978, 2000, 2069, 2119, 2105, 2039, 1982, 1987, 2050, 2113, 2117, 2060, 1993, 1979, 2033, 2101, 2121, 2074, 2005, 1975, 2017, 2086, 2124, 2091, 2023, 1978, 2002, 2069, 2118, 2103, 2038, 1981, 1988, 2051, 2113, 2118, 2060, 1992, 1979, 2032, 2101, 2121, 2074, 2004, 1975, 2017, 2087, 2124, 2091, 2021, 1977, 2001, 2071, 2120, 2105, 2038, 1981, 1988, 2052, 2114, 2117, 2057, 1990, 1978, 2033, 2103, 2125, 2076, 2005, 1973, 2012, 2084, 2123, 2094, 2025, 1979, 2000, 2066, 2115, 2100, 2037, 1985, 1993, 2056, 2114, 2114, 2055, 1989, 1978, 2033, 2103, 2124, 2076, 2003, 1972, 2012, 2086, 2127, 2096, 2023, 1976, 1997, 2067, 2118, 2104, 2040, 1984, 1990, 2051, 2111, 2113, 2057, 1994, 1982, 2034, 2100, 2120, 2074, 2004, 1974, 2014, 2086, 2125, 2095, 2023, 1975, 1998, 2067, 2120, 2106, 2038, 1981, 1988, 2050, 2112, 2117, 2059, 1993, 1982, 2033, 2100, 2119, 2073, 2005, 1976, 2015, 2085, 2124, 2094, 2023, 1978, 1999, 2068, 2119, 2105, 2038, 1981, 1986, 2050, 2114, 2118, 2059, 1991, 1978, 2032, 2101, 2122, 2074, 2005, 1975, 2014, 2086, 2123, 2093, 2023, 1978, 1999, 2068, 2120, 2105, 2040, 1981, 1987, 2049, 2112, 2116, 2060, 1994, 1981, 2033, 2100, 2120, 2074, 2003, 1974, 2015, 2086, 2125, 2095, 2024, 1976, 1997, 2067, 2119, 2105, 2039, 1982, 1988, 2050, 2113, 2118, 2061, 1994, 1978, 2031, 2098, 2121, 2076, 2006, 1975, 2014, 2085, 2123, 2093, 2024, 1977, 2000, 2068, 2120, 2104, 2038, 1980, 1986, 2049, 2112, 2117, 2062, 1994, 1979, 2031, 2098, 2121, 2076, 2005, 1975, 2014, 2085, 2125, 2094, 2024, 1978, 2000, 2067, 2118, 2104, 2039, 1982, 1987, 2049, 2112, 2117, 2061, 1995, 1980, 2031, 2098, 2121, 2076, 2006, 1975, 2013, 2085, 2124, 2094, 2023, 1977, 1999, 2068, 2119, 2104, 2039, 1981, 1987, 2049, 2113, 2117, 2061, 1994, 1979, 2030, 2098, 2121, 2077, 2007, 1975, 2012, 2084, 2123, 2095, 2025, 1978, 1999, 2067, 2120, 2105, 2039, 1981, 1987, 2050, 2112, 2117, 2061, 1995, 1981, 2031, 2098, 2120, 2075, 2005, 1975, 2013, 2084, 2123, 2095, 2027, 1977, 1998, 2066, 2119, 2106, 2040, 1982, 1987, 2049, 2112, 2118, 2061, 1994, 1979, 2031, 2100, 2122, 2076, 2006, 1976, 2014, 2083, 2122, 2094, 2025, 1980, 2000, 2067, 2118, 2104, 2039, 1982, 1986, 2048, 2112, 2120, 2063, 1995, 1978, 2030, 2099, 2122, 2075, 2005, 1975, 2014, 2085, 2124, 2094, 2025, 1979, 2002, 2068, 2117, 2103, 2038, 1982, 1988, 2051, 2113, 2119, 2060, 1993, 1978, 2030, 2100, 2123, 2076, 2007, 1975, 2013, 2083, 2122, 2094, 2024, 1979, 2001, 2069, 2120, 2105, 2038, 1981, 1985, 2048, 2112, 2119, 2062, 1995, 1980, 2031, 2097, 2121, 2076, 2007, 1975, 2014, 2083, 2123, 2093, 2025, 1979, 2000, 2069, 2119, 2104, 2037, 1980, 1987, 2050, 2114, 2119, 2061, 1994, 1979, 2031, 2098, 2122, 2076, 2006, 1975, 2012, 2084, 2123, 2096, 2026, 1977, 1999, 2067, 2118, 2104, 2040, 1983, 1987, 2049, 2111, 2116, 2059, 1995, 1981, 2032, 2100, 2121, 2075, 2005, 1974, 2013, 2084, 2123, 2095, 2025, 1979, 2000, 2067, 2118, 2105, 2039, 1981, 1986, 2048, 2113, 2118, 2062, 1995, 1979, 2029, 2098, 2120, 2075, 2006, 1977, 2015, 2084, 2122, 2093, 2024, 1978, 1999, 2067, 2119, 2106, 2041, 1982, 1986, 2049, 2111, 2117, 2060, 1994, 1979, 2032, 2100, 2122, 2075, 2005, 1975, 2013, 2084, 2124, 2095, 2026, 1979, 1999, 2067, 2118, 2105, 2040, 1983, 1987, 2048, 2112, 2117, 2060, 1995, 1979, 2031, 2100, 2121, 2074, 2004, 1975, 2014, 2085, 2124, 2094, 2023, 1978, 1999, 2068, 2120, 2105, 2039, 1982, 1986, 2047, 2112, 2118, 2062, 1996, 1979, 2030, 2098, 2121, 2076, 2006, 1975, 2013, 2085, 2125, 2095, 2024, 1977, 2000, 2068, 2120, 2106, 2039, 1983, 1987, 2048, 2111, 2117, 2061, 1996, 1980, 2030, 2099, 2121, 2076, 2005, 1974, 2012, 2085, 2125, 2095, 2025, 1978, 1999, 2066, 2118, 2105, 2040, 1981, 1987, 2049, 2112, 2117, 2060, 1995, 1980, 2030, 2099, 2121, 2075, 2006, 1975, 2013, 2084, 2124, 2095, 2025, 1977, 1998, 2066, 2120, 2108, 2041, 1981, 1985, 2046, 2112, 2118, 2062, 1996, 1981, 2032, 2099, 2121, 2075, 2005, 1974, 2013, 2084, 2125, 2096, 2027, 1978, 1998, 2065, 2118, 2105, 2040, 1981, 1987, 2049, 2113, 2118, 2061, 1994, 1979, 2031, 2100, 2122, 2075, 2006, 1975, 2013, 2085, 2124, 2095, 2024, 1977, 1998, 2066, 2120, 2106, 2042, 1982, 1985, 2047, 2111, 2118, 2062, 1995, 1979, 2030, 2099, 2122, 2076, 2004, 1975, 2014, 2085, 2124, 2094, 2025, 1978, 1999, 2067, 2119, 2105, 2040, 1981, 1987, 2048, 2112, 2119, 2063, 1995, 1977, 2029, 2099, 2123, 2077, 2006, 1974, 2012, 2084, 2124, 2096, 2026, 1977, 1998, 2065, 2118, 2105, 2041, 1983, 1987, 2048, 2111, 2117, 2062, 1996, 1979, 2030, 2099, 2121, 2076, 2005, 1973, 2012, 2085, 2127, 2097, 2024, 1975, 1996, 2066, 2120, 2108, 2041, 1983, 1985, 2046, 2111, 2120, 2063, 1997, 1980
};

#ifdef NPU_VERIFICATION
// test vectors for AI model only
float model_input_top_float[256] = {62.40153, -16.28627, -25.82316, -31.87877, -37.28831, -39.04589, -46.61464, -40.39658, -47.47245, -41.16836, -37.91529, -41.04264, -34.52249, -42.47686, -48.40818, -35.14987, -39.47035, -49.95920, -44.19976, -39.31337, -35.97435, -42.91134, -40.37961, -44.68617, -43.04738, -39.21758, -40.65794, -38.57610, -40.68549, -40.36964, -48.77987, -33.02006, -36.86376, -35.93813, -34.65084, -34.97559, -31.13984, -37.45194, -34.78003, -26.22644, -6.52262, -19.59521, -36.36634, -35.27591, -36.49093, -35.42947, -41.94986, -36.16201, -40.83050, -18.11613, -28.92337, -32.70733, -26.62770, -20.97941, -27.42509, -30.79614, -32.44706, -24.45440, -30.95929, -27.29785, -18.98495, -23.49411, -14.87995, -18.79211, -20.05285, -18.26873, -18.17088, -19.76623, -18.36816, -32.09077, -28.93580, -30.57381, -27.15122, -36.68414, -43.35796, -40.47142, -34.38663, -29.12779, -33.09602, -24.74635, -1.22975, 33.88785, 19.90853, -19.66865, -30.00154, -38.26071, -35.70638, -42.07643, -35.83428, -35.09797, -42.92609, -35.65555, -42.41531, -40.61490, -30.61367, -30.57120, -22.91964, -27.70689, -23.04162, -19.44358, -36.62267, -37.25460, -34.26702, -30.43338, -38.07528, -40.88788, -27.03310, -40.63744, -50.83123, -42.05446, -42.13220, -41.81277, -54.00733, -48.94602, -43.00138, -44.83147, -42.41813, -44.20658, -35.59015, -37.06339, -42.03700, -42.26255, -23.34311, -34.90911, -37.54058, -33.06463, -33.90012, -32.33129, -46.65921, -41.86737, -37.84091, -40.83599, -39.15161, -45.39868, -43.46513, -36.54299, -43.50926, -38.50432, -36.75264, -46.46027, -58.25233, -42.94260, -51.23143, -34.47216, -42.29916, -40.23951, -43.42303, -34.84896, -40.33779, -47.08558, -48.46026, -47.41643, -44.81510, -50.39085, -41.15772, -42.43735, -43.09047, -51.05080, -50.80545, -46.28526, -41.48351, -36.48028, -47.25689, -30.99787, -37.04929, -40.08582, -42.11886, -36.99236, -34.48587, -35.94049, -39.66363, -40.59642, -39.70159, -36.88393, -39.54913, -44.62108, -46.36489, -39.66216, -38.21612, -39.96629, -41.16489, -45.41302, -41.52378, -43.18002, -42.01826, -36.27995, -44.02112, -42.97797, -53.85733, -45.62101, -38.39979, -35.05496, -38.37326, -38.70749, -39.67714, -45.06321, -49.45675, -42.19275, -38.60435, -44.45334, -41.48735, -49.00806, -40.06916, -43.37053, -41.54053, -41.10316, -38.87351, -40.07784, -46.96297, -40.67113, -45.93964, -36.05269, -44.51347, -39.01590, -34.90641, -36.69867, -40.21312, -36.70182, -37.96793, -36.72719, -36.66226, -45.08770, -42.38237, -34.76321, -32.36384, -39.55880, -47.95231, -48.51941, -45.65275, -48.18397, -42.30368, -51.22424, -43.18318, -39.19510, -42.69133, -47.43641, -41.84376, -40.81637, -46.30430, -46.10350, -37.00237, -44.02605, -37.22812, -39.47868, -32.35901, -23.11597, -45.43240, -36.17629, -35.15845, -49.76126, -44.55403, -54.92822, -44.11072, -43.33772, -49.98219, -29.86006
};
#endif

// NN model output
int8_t golden_output[2] = {-89, 87};
