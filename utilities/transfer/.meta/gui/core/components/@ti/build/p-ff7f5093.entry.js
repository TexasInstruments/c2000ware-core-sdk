import{r as t,c as e,h as i,g as o}from"./p-823ca21f.js";import{W as r}from"./p-b29896ef.js";import{ServicesRegistry as s}from"../gc-core-services/lib/ServicesRegistry";import{projectBuildServiceType as n}from"../gc-service-project-build/lib/ProjectBuildService";import{GcConsole as c}from"../gc-core-assets/lib/GcConsole";import{GcUtils as a}from"../gc-core-assets/lib/GcUtils";import"../gc-core-assets/lib/GcFiles";import"../gc-core-assets/lib/GcLocalStorage";import"../gc-widget-message-dialog/lib/GcMessageDialog";const l=':host::-webkit-scrollbar,::-webkit-scrollbar{width:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px));height:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px))}:host::-webkit-scrollbar-track,::-webkit-scrollbar-track{background:var(--gc-scrollbar-track-background-color, var(--theme-scroll-track-color, rgba(35, 31, 32, 0.2)))}:host::-webkit-scrollbar-thumb,::-webkit-scrollbar-thumb{background:var(--gc-scrollbar-thumb-background-color, var(--theme-scroll-thumb-color, rgba(35, 31, 32, 0.65)))}:host::-webkit-scrollbar-thumb:hover,::-webkit-scrollbar-thumb:hover{background:var(--gc-scrollbar-thumb-background-color-hover, var(--theme-scroll-thumb-color-hover, rgba(35, 31, 32, 0.8)))}:host::-webkit-scrollbar-corner,::-webkit-scrollbar-corner{background:rgba(0, 0, 0, 0)}:host(:focus),:host *:focus{outline:none}:host{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;font-family:var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif"));font-size:var(--gc-font-size, var(--theme-font-size, 14px));font-weight:400;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));margin:var(--gc-margin, var(--theme-margin, 5px));display:inline-block;box-sizing:border-box}:host .user-select{-webkit-user-select:text;-khtml-user-select:text;-moz-user-select:text;-ms-user-select:text;-o-user-select:text;user-select:text}:host .text-link{color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-text-decoration-hover:underline;--gc-cursor-hover:pointer}:host .text-link:not([disabled]):hover{text-decoration:underline;cursor:pointer}:host([hidden]){display:none !important}:host([readonly]) *{pointer-events:none}:host([disabled]) *{cursor:not-allowed}:host([caption]:not([caption=""])){margin-top:calc(var(--gc-margin, var(--theme-margin, 5px)) + var(--gc-caption-font-size, var(--theme-caption-font-size, 14px)) + 8px)}:host([caption]:not([caption=""])),:host([info-text]:not([info-text=""])){overflow:visible;position:relative}:host([caption=""][info-text]:not([info-text=""])),:host([info-text]:not([info-text=""]):not([caption])){margin-right:calc(var(--gc-margin, var(--theme-margin, 5px)) + 22px)}#elementWrapper{box-sizing:content-box;height:100%;width:100%;display:flex;align-items:center;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container{position:relative;display:flex;flex-direction:column;width:100%;height:100%;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container .header-container.top{top:var(--gc-header-container-top, calc(0px - 8px - var(--gc-caption-font-size, var(--theme-caption-font-size, 14px))));flex-direction:row}.root-container .header-container.side{right:-22px;flex-direction:column;height:inherit}.root-container .header-container{position:absolute;display:flex;align-items:center}.root-container .header-container .icon,.root-container .header-container gc-widget-icon{cursor:default;margin:auto;height:18px;width:18px;display:block;--gc-color:var(--gc-caption-info-color, var(--theme-caption-info-color, #98999b))}.root-container .header-container .caption{flex:1;cursor:default;white-space:nowrap;margin-right:2px;font-weight:var(--gc-caption-font-weight, var(--theme-caption-font-weight, 400));font-size:var(--gc-caption-font-size, var(--theme-caption-font-size, 14px));color:var(--gc-caption-font-color, var(--theme-caption-font-color, #999999))}.invisible{visibility:hidden}:host #project-build-container{height:100%;width:100%;display:flex;flex-direction:column}:host #project-build-container #button-container{display:flex}:host #project-build-container gc-widget-terminal{height:calc(100% - 50px);width:100%}';let h=class{constructor(i){t(this,i);this.projectBuildCompletedEvent=e(this,"project-build-completed",7);this.projectImportCompletedEvent=e(this,"project-import-completed",7);this.cssPropertyChanged=e(this,"css-property-changed",7);this.logger=new c("gc-widget-project-build");this.commandInProgress=false;this.showImportButton=true;this.loggerHandler=t=>{if(this.terminalWidget){this.terminalWidget.displayInput=t}};this.autoImport=false;this._refresh=0;this.hidden=false;this.disabled=false}async componentWillRender(){if(this.autoImport){this.showImportButton=false}else{this.showImportButton=true}}render(){const t=this.el.id+-"terminal";if(!this.buildConfiguration||!this.sdkId||!this.projectPath){return i("gc-widget-icon",{size:"m",id:"errorMessageIcon",icon:"alert:warning",appearance:"warn",tooltip:"Missing required properties"})}return r.doRender(i("div",{id:"project-build-container"},i("div",{id:"button-container"},this.showImportButton?i("gc-widget-button",{disabled:this.disabled,label:"Import",onClick:()=>this.importProject()}):i("div",null),i("gc-widget-button",{disabled:this.disabled,label:"Build",onClick:()=>this.buildProject()}),i("gc-widget-button",{disabled:this.disabled,label:"Export Workspace",onClick:()=>this.exportWorkspace()})),i("gc-widget-terminal",{readonly:true,id:t,ref:t=>this.terminalWidget=t})),{caption:this.caption,infoText:this.infoText,tooltip:this.tooltip})}async componentDidRender(){if(this.autoImport&&!await this.projectExists()){this.importProject()}}async exportWorkspace(){const t=`/workspaceserver/app/Default/${a.appName}?command=pack&type=tar`;const e=window.location.origin+t;const i=await fetch(e);const o=await i.blob();const r=document.createElement("a");r.href=window.URL.createObjectURL(o);r.download=a.appName+"_workspace.tar";r.style.display="none";this.el.appendChild(r);r.dispatchEvent(new MouseEvent("click"));this.el.removeChild(r)}async projectExists(){const t=s.getService(n);const e=this.projectPath.split("/");const i=e[e.length-1].split(".")[0];return await t.projectExists(i)}async importProject(){const t=s.getService(n);let e=this.sdkId;if(this.sdkId.startsWith("${")){if(this.sdkVersion!==undefined){e=[this.sdkId.slice(0,this.sdkId.indexOf("}")),":"+this.sdkVersion,this.sdkId.slice(this.sdkId.indexOf("}"))].join("")}else{e=this.sdkId}}if(!this.commandInProgress){this.commandInProgress=true;this.loggerHandler("\nProject Import started...");await t.importProject(e,this.projectPath.replace(/\\/g,"/"),this.loggerHandler);this.projectImportCompletedEvent.emit();this.loggerHandler("\nProject Import Complete.");this.commandInProgress=false}}async buildProject(){const t=s.getService(n);await this.saveSysconfigScript();const e=this.projectPath.replace(/\\/g,"/").split("/");const i=e[e.length-1].split(".")[0];if(!this.commandInProgress){this.commandInProgress=true;this.loggerHandler("\nProject Build started...");await t.buildProject(i,this.buildConfiguration,this.loggerHandler);this.projectBuildCompletedEvent.emit();this.loggerHandler("\nProject Build Complete.");this.commandInProgress=false}}saveSysconfigScript(){const t=document.querySelectorAll("gc-model-sysconfig");const e=[];if(t){t.forEach((async t=>{e.push(t.saveConfigScript())}))}return Promise.all(e)}async setCSSProperty(t,e){e=e.trim();if(await this.getCSSProperty(t)!==e){this.el.style.setProperty(t,e);this.cssPropertyChanged.emit({name:t,value:e})}}async getCSSProperty(t){return getComputedStyle(this.el).getPropertyValue(t).trim()}async refresh(){this._refresh++}get el(){return o(this)}};h.style=l;export{h as gc_widget_project_build};
//# sourceMappingURL=p-ff7f5093.entry.js.map